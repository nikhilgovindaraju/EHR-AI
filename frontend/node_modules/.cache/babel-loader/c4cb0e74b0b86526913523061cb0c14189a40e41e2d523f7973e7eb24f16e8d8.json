{"ast":null,"code":"var _jsxFileName = \"/Users/nikhilgovindaraju/Documents/Projects/EHR-AI/frontend/src/pages/AuditChatbot.js\",\n  _s = $RefreshSig$();\n// import React, { useState, useEffect, useRef } from \"react\";\n// import \"../styles/chatbot.css\";\n// import axios from \"../services/api\";\n// import swoosh from \"../assets/woosh.wav\";\n\n// function AuditChatbot() {\n//   const [open, setOpen] = useState(false);\n//   const [messages, setMessages] = useState([\n//     { type: \"bot\", text: \"üëã Hi! I‚Äôm your SecureEHR Assistant. Ask about a patient or your recent cases.\" }\n//   ]);\n//   const [input, setInput] = useState(\"\");\n//   const [patientId, setPatientId] = useState(\"\"); // optional target patient\n//   const [loading, setLoading] = useState(false);\n\n//   const messagesEndRef = useRef(null);\n//   const audioRef = useRef(null);\n\n//   const userId = localStorage.getItem(\"user_id\");\n//   const role = localStorage.getItem(\"role\");\n\n//   const quickQuestions = [\n//     \"Show Patient1‚Äôs last visit summary\",\n//     \"List the most common diagnosis in my last 10 cases\",\n//     \"Summarize medications for Patient1\",\n//     \"When was the last visit?\"\n//   ];\n\n//   useEffect(() => {\n//     messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n//   }, [messages, loading]);\n\n//   const playSound = () => audioRef.current?.play();\n\n//   const sendMessage = async (preset) => {\n//     const content = preset || input.trim();\n//     if (!content) return;\n\n//     // add user message\n//     setMessages((prev) => [...prev, { type: \"user\", text: content }]);\n//     setInput(\"\");\n//     playSound();\n//     setLoading(true);\n\n//     try {\n//       // call the new unified chat endpoint (LLM + RAG)\n//       const { data } = await axios.post(\"/api/audit/chat\", {\n//         user_id: userId,\n//         role, // \"doctor\" | \"patient\"\n//         question: content,\n//         patient_id: patientId || undefined, // optional: set by input above\n//       });\n\n//       const reply = data?.answer || \"ü§ñ I couldn't find the answer to that.\";\n//       setMessages((prev) => [...prev, { type: \"bot\", text: reply }]);\n//       playSound();\n//     } catch (err) {\n//       console.error(\"Chat error:\", err?.response?.data || err.message);\n//       setMessages((prev) => [\n//         ...prev,\n//         { type: \"bot\", text: \"‚ùå Error processing your request.\" },\n//       ]);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   return (\n//     <>\n//       <audio ref={audioRef} src={swoosh} preload=\"auto\" />\n//       {!open && (\n//         <div className=\"chatbot-button\" onClick={() => setOpen(true)}>\n//           <i className=\"bi bi-chat-dots-fill\"></i>\n//         </div>\n//       )}\n//       {open && (\n//         <div className=\"chatbot-window\">\n//           <div className=\"chatbot-header\">\n//             <span>SecureEHR Assistant</span>\n//             <button className=\"close-btn\" onClick={() => setOpen(false)}>\n//               &times;\n//             </button>\n//           </div>\n\n//           {/* Target patient (optional) */}\n//           <div className=\"chatbot-toolbar\">\n//             <input\n//               className=\"chatbot-patient\"\n//               placeholder=\"(Optional) Patient ID, e.g., Patient1\"\n//               value={patientId}\n//               onChange={(e) => setPatientId(e.target.value)}\n//             />\n//           </div>\n\n//           <div className=\"chatbot-body\">\n//             {messages.map((m, i) => (\n//               <div key={i} className={`message ${m.type}`}>{m.text}</div>\n//             ))}\n//             {loading && <div className=\"message bot\">‚è≥ Thinking‚Ä¶</div>}\n//             <div ref={messagesEndRef} />\n//           </div>\n\n//           <div className=\"chatbot-faq\">\n//             {quickQuestions.map((q, idx) => (\n//               <button key={idx} onClick={() => sendMessage(q)}>{q}</button>\n//             ))}\n//           </div>\n\n//           <div className=\"chatbot-input-area\">\n//             <input\n//               type=\"text\"\n//               placeholder='Try: \"Show Patient1‚Äôs last visit summary\"'\n//               value={input}\n//               onChange={(e) => setInput(e.target.value)}\n//               onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\n//             />\n//             <button onClick={() => sendMessage()}>\n//               <i className=\"bi bi-send-fill\"></i>\n//             </button>\n//           </div>\n//         </div>\n//       )}\n//     </>\n//   );\n// }\n\n// export default AuditChatbot;\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport \"../styles/chatbot.css\";\nimport axios from \"../services/api\";\nimport swoosh from \"../assets/woosh.wav\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction AuditChatbot() {\n  _s();\n  const [open, setOpen] = useState(false);\n  const [messages, setMessages] = useState([{\n    type: \"bot\",\n    text: \"üëã Hi! I‚Äôm your SecureEHR Assistant. Ask about a patient or your recent cases.\"\n  }]);\n  const [input, setInput] = useState(\"\");\n  const [patientId, setPatientId] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [showContextIdx, setShowContextIdx] = useState(null);\n  const messagesEndRef = useRef(null);\n  const audioRef = useRef(null);\n  const userId = localStorage.getItem(\"user_id\");\n  const role = localStorage.getItem(\"role\");\n  const storedPatientId = (localStorage.getItem(\"patient_id\") || \"\").trim();\n\n  // auto-fill patientId for Patient role\n  useEffect(() => {\n    if (role === \"patient\") {\n      setPatientId(storedPatientId || userId || \"\");\n    }\n  }, [role, storedPatientId, userId]);\n  const quickQuestions = [\"Show Patient1‚Äôs last visit summary\", \"List the most common diagnosis in my last 10 cases\", \"Summarize medications for Patient1\", \"When was the last visit?\"];\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages, loading]);\n  const playSound = () => {\n    var _audioRef$current;\n    return (_audioRef$current = audioRef.current) === null || _audioRef$current === void 0 ? void 0 : _audioRef$current.play();\n  };\n  const sendMessage = async preset => {\n    const content = preset || input.trim();\n    if (!content) return;\n    setMessages(prev => [...prev, {\n      type: \"user\",\n      text: content\n    }]);\n    setInput(\"\");\n    playSound();\n    setLoading(true);\n    try {\n      const {\n        data\n      } = await axios.post(\"/api/audit/chat\", {\n        user_id: userId,\n        role,\n        question: content,\n        patient_id: role === \"patient\" ? patientId || userId : patientId || undefined,\n        // Optionally also send a name the backend can match on\n        patient_name: role === \"patient\" ? userId : undefined\n      });\n      const botMsg = {\n        type: \"bot\",\n        text: (data === null || data === void 0 ? void 0 : data.answer) || \"ü§ñ I couldn't find the answer to that.\",\n        stats: (data === null || data === void 0 ? void 0 : data.stats) || null,\n        rows: Array.isArray(data === null || data === void 0 ? void 0 : data.rows) ? data.rows : []\n      };\n      setMessages(prev => [...prev, botMsg]);\n      playSound();\n    } catch (err) {\n      var _err$response;\n      console.error(\"Chat error:\", (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n      setMessages(prev => [...prev, {\n        type: \"bot\",\n        text: \"‚ùå Error processing your request.\"\n      }]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const StatChips = ({\n    stats\n  }) => {\n    if (!stats) return null;\n    const diag = (stats.top_diagnoses || []).map(([d, c]) => `${d} (${c})`).join(\", \");\n    const meds = (stats.top_medications || []).map(([m, c]) => `${m} (${c})`).join(\", \");\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatbot-stats\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"chip\",\n        children: [\"Total logs: \", stats.total_logs]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this), stats.last_visit && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"chip\",\n        children: [\"Last visit: \", new Date(stats.last_visit).toLocaleString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 30\n      }, this), diag && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"chip\",\n        children: [\"Top Dx: \", diag]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 18\n      }, this), meds && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"chip\",\n        children: [\"Top Meds: \", meds]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 7\n    }, this);\n  };\n  const ContextTable = ({\n    rows\n  }) => {\n    if (!rows || rows.length === 0) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-muted\",\n      children: \"No context records.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 44\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ctx-table-wrap\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"ctx-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Timestamp\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Patient\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Age\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Diagnosis\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Medication\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Notes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Action\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: rows.map((r, i) => {\n            var _r$age;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.timestamp ? new Date(r.timestamp).toLocaleString() : \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.patient_name || r.patient_id || \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: (_r$age = r.age) !== null && _r$age !== void 0 ? _r$age : \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.diagnosis || \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.medication || \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: (r.notes || \"\").toString().trim() || \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: r.action || \"‚Äî\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 17\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: audioRef,\n      src: swoosh,\n      preload: \"auto\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }, this), !open && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatbot-button\",\n      onClick: () => setOpen(true),\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"bi bi-chat-dots-fill\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 9\n    }, this), open && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatbot-window\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"SecureEHR Assistant\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"close-btn\",\n          onClick: () => setOpen(false),\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-toolbar\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"chatbot-patient\",\n          placeholder: \"(Optional) Patient ID, e.g., Patient1\",\n          value: patientId,\n          onChange: e => setPatientId(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-body\",\n        children: [messages.map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${m.type}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              whiteSpace: \"pre-wrap\"\n            },\n            children: m.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 17\n          }, this), m.type === \"bot\" && (m.stats || m.rows && m.rows.length > 0) && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(StatChips, {\n              stats: m.stats\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ctx-toggle\",\n              onClick: () => setShowContextIdx(showContextIdx === i ? null : i),\n              children: showContextIdx === i ? \"Hide context ‚ñ≤\" : \"Show context ‚ñº\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 21\n            }, this), showContextIdx === i && /*#__PURE__*/_jsxDEV(ContextTable, {\n              rows: m.rows\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 46\n            }, this)]\n          }, void 0, true)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 15\n        }, this)), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message bot\",\n          children: \"\\u23F3 Thinking\\u2026\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-faq\",\n        children: quickQuestions.map((q, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => sendMessage(q),\n          children: q\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatbot-input-area\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Try: \\\"Show Patient1\\u2019s last visit summary\\\"\",\n          value: input,\n          onChange: e => setInput(e.target.value),\n          onKeyDown: e => e.key === \"Enter\" && sendMessage()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => sendMessage(),\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-send-fill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(AuditChatbot, \"Vl4VOH9KSzvKHy18BqA+Q08FTZw=\");\n_c = AuditChatbot;\nexport default AuditChatbot;\nvar _c;\n$RefreshReg$(_c, \"AuditChatbot\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","swoosh","jsxDEV","_jsxDEV","Fragment","_Fragment","AuditChatbot","_s","open","setOpen","messages","setMessages","type","text","input","setInput","patientId","setPatientId","loading","setLoading","showContextIdx","setShowContextIdx","messagesEndRef","audioRef","userId","localStorage","getItem","role","storedPatientId","trim","quickQuestions","_messagesEndRef$curre","current","scrollIntoView","behavior","playSound","_audioRef$current","play","sendMessage","preset","content","prev","data","post","user_id","question","patient_id","undefined","patient_name","botMsg","answer","stats","rows","Array","isArray","err","_err$response","console","error","response","message","StatChips","diag","top_diagnoses","map","d","c","join","meds","top_medications","m","className","children","total_logs","fileName","_jsxFileName","lineNumber","columnNumber","last_visit","Date","toLocaleString","ContextTable","length","r","i","_r$age","timestamp","age","diagnosis","medication","notes","toString","action","ref","src","preload","onClick","placeholder","value","onChange","e","target","style","whiteSpace","q","idx","onKeyDown","key","_c","$RefreshReg$"],"sources":["/Users/nikhilgovindaraju/Documents/Projects/EHR-AI/frontend/src/pages/AuditChatbot.js"],"sourcesContent":["// import React, { useState, useEffect, useRef } from \"react\";\n// import \"../styles/chatbot.css\";\n// import axios from \"../services/api\";\n// import swoosh from \"../assets/woosh.wav\";\n\n// function AuditChatbot() {\n//   const [open, setOpen] = useState(false);\n//   const [messages, setMessages] = useState([\n//     { type: \"bot\", text: \"üëã Hi! I‚Äôm your SecureEHR Assistant. Ask about a patient or your recent cases.\" }\n//   ]);\n//   const [input, setInput] = useState(\"\");\n//   const [patientId, setPatientId] = useState(\"\"); // optional target patient\n//   const [loading, setLoading] = useState(false);\n\n//   const messagesEndRef = useRef(null);\n//   const audioRef = useRef(null);\n\n//   const userId = localStorage.getItem(\"user_id\");\n//   const role = localStorage.getItem(\"role\");\n\n//   const quickQuestions = [\n//     \"Show Patient1‚Äôs last visit summary\",\n//     \"List the most common diagnosis in my last 10 cases\",\n//     \"Summarize medications for Patient1\",\n//     \"When was the last visit?\"\n//   ];\n\n//   useEffect(() => {\n//     messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n//   }, [messages, loading]);\n\n//   const playSound = () => audioRef.current?.play();\n\n//   const sendMessage = async (preset) => {\n//     const content = preset || input.trim();\n//     if (!content) return;\n\n//     // add user message\n//     setMessages((prev) => [...prev, { type: \"user\", text: content }]);\n//     setInput(\"\");\n//     playSound();\n//     setLoading(true);\n\n//     try {\n//       // call the new unified chat endpoint (LLM + RAG)\n//       const { data } = await axios.post(\"/api/audit/chat\", {\n//         user_id: userId,\n//         role, // \"doctor\" | \"patient\"\n//         question: content,\n//         patient_id: patientId || undefined, // optional: set by input above\n//       });\n\n//       const reply = data?.answer || \"ü§ñ I couldn't find the answer to that.\";\n//       setMessages((prev) => [...prev, { type: \"bot\", text: reply }]);\n//       playSound();\n//     } catch (err) {\n//       console.error(\"Chat error:\", err?.response?.data || err.message);\n//       setMessages((prev) => [\n//         ...prev,\n//         { type: \"bot\", text: \"‚ùå Error processing your request.\" },\n//       ]);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   return (\n//     <>\n//       <audio ref={audioRef} src={swoosh} preload=\"auto\" />\n//       {!open && (\n//         <div className=\"chatbot-button\" onClick={() => setOpen(true)}>\n//           <i className=\"bi bi-chat-dots-fill\"></i>\n//         </div>\n//       )}\n//       {open && (\n//         <div className=\"chatbot-window\">\n//           <div className=\"chatbot-header\">\n//             <span>SecureEHR Assistant</span>\n//             <button className=\"close-btn\" onClick={() => setOpen(false)}>\n//               &times;\n//             </button>\n//           </div>\n\n//           {/* Target patient (optional) */}\n//           <div className=\"chatbot-toolbar\">\n//             <input\n//               className=\"chatbot-patient\"\n//               placeholder=\"(Optional) Patient ID, e.g., Patient1\"\n//               value={patientId}\n//               onChange={(e) => setPatientId(e.target.value)}\n//             />\n//           </div>\n\n//           <div className=\"chatbot-body\">\n//             {messages.map((m, i) => (\n//               <div key={i} className={`message ${m.type}`}>{m.text}</div>\n//             ))}\n//             {loading && <div className=\"message bot\">‚è≥ Thinking‚Ä¶</div>}\n//             <div ref={messagesEndRef} />\n//           </div>\n\n//           <div className=\"chatbot-faq\">\n//             {quickQuestions.map((q, idx) => (\n//               <button key={idx} onClick={() => sendMessage(q)}>{q}</button>\n//             ))}\n//           </div>\n\n//           <div className=\"chatbot-input-area\">\n//             <input\n//               type=\"text\"\n//               placeholder='Try: \"Show Patient1‚Äôs last visit summary\"'\n//               value={input}\n//               onChange={(e) => setInput(e.target.value)}\n//               onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\n//             />\n//             <button onClick={() => sendMessage()}>\n//               <i className=\"bi bi-send-fill\"></i>\n//             </button>\n//           </div>\n//         </div>\n//       )}\n//     </>\n//   );\n// }\n\n// export default AuditChatbot;\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport \"../styles/chatbot.css\";\nimport axios from \"../services/api\";\nimport swoosh from \"../assets/woosh.wav\";\n\nfunction AuditChatbot() {\n  const [open, setOpen] = useState(false);\n  const [messages, setMessages] = useState([\n    { type: \"bot\", text: \"üëã Hi! I‚Äôm your SecureEHR Assistant. Ask about a patient or your recent cases.\" }\n  ]);\n  const [input, setInput] = useState(\"\");\n  const [patientId, setPatientId] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [showContextIdx, setShowContextIdx] = useState(null);\n\n  const messagesEndRef = useRef(null);\n  const audioRef = useRef(null);\n\n  const userId = localStorage.getItem(\"user_id\");\n  const role = localStorage.getItem(\"role\");\n\n  const storedPatientId = (localStorage.getItem(\"patient_id\") || \"\").trim();\n\n// auto-fill patientId for Patient role\nuseEffect(() => {\n  if (role === \"patient\") {\n    setPatientId(storedPatientId || userId || \"\");\n  }\n}, [role, storedPatientId, userId]);\n\n  const quickQuestions = [\n    \"Show Patient1‚Äôs last visit summary\",\n    \"List the most common diagnosis in my last 10 cases\",\n    \"Summarize medications for Patient1\",\n    \"When was the last visit?\"\n  ];\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages, loading]);\n\n  const playSound = () => audioRef.current?.play();\n\n  const sendMessage = async (preset) => {\n    const content = preset || input.trim();\n    if (!content) return;\n\n    setMessages((prev) => [...prev, { type: \"user\", text: content }]);\n    setInput(\"\");\n    playSound();\n    setLoading(true);\n\n    try {\n      const { data } = await axios.post(\"/api/audit/chat\", {\n        user_id: userId,\n        role,\n        question: content,\n        patient_id: role === \"patient\" ? (patientId || userId) : (patientId || undefined),\n        // Optionally also send a name the backend can match on\n        patient_name: role === \"patient\" ? userId : undefined,\n      });\n\n      const botMsg = {\n        type: \"bot\",\n        text: data?.answer || \"ü§ñ I couldn't find the answer to that.\",\n        stats: data?.stats || null,\n        rows: Array.isArray(data?.rows) ? data.rows : [],\n      };\n      setMessages((prev) => [...prev, botMsg]);\n      playSound();\n    } catch (err) {\n      console.error(\"Chat error:\", err?.response?.data || err.message);\n      setMessages((prev) => [\n        ...prev,\n        { type: \"bot\", text: \"‚ùå Error processing your request.\" },\n      ]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const StatChips = ({ stats }) => {\n    if (!stats) return null;\n    const diag = (stats.top_diagnoses || []).map(([d, c]) => `${d} (${c})`).join(\", \");\n    const meds = (stats.top_medications || []).map(([m, c]) => `${m} (${c})`).join(\", \");\n    return (\n      <div className=\"chatbot-stats\">\n        <span className=\"chip\">Total logs: {stats.total_logs}</span>\n        {stats.last_visit && <span className=\"chip\">Last visit: {new Date(stats.last_visit).toLocaleString()}</span>}\n        {diag && <span className=\"chip\">Top Dx: {diag}</span>}\n        {meds && <span className=\"chip\">Top Meds: {meds}</span>}\n      </div>\n    );\n  };\n\n  const ContextTable = ({ rows }) => {\n    if (!rows || rows.length === 0) return <div className=\"text-muted\">No context records.</div>;\n    return (\n      <div className=\"ctx-table-wrap\">\n        <table className=\"ctx-table\">\n          <thead>\n            <tr>\n              <th>Timestamp</th>\n              <th>Patient</th>\n              <th>Age</th>\n              <th>Diagnosis</th>\n              <th>Medication</th>\n              <th>Notes</th>\n              <th>Action</th>\n            </tr>\n          </thead>\n          <tbody>\n            {rows.map((r, i) => (\n              <tr key={i}>\n                <td>{r.timestamp ? new Date(r.timestamp).toLocaleString() : \"‚Äî\"}</td>\n                <td>{r.patient_name || r.patient_id || \"‚Äî\"}</td>\n                <td>{r.age ?? \"‚Äî\"}</td>\n                <td>{r.diagnosis || \"‚Äî\"}</td>\n                <td>{r.medication || \"‚Äî\"}</td>\n                <td>{(r.notes || \"\").toString().trim() || \"‚Äî\"}</td>\n                <td>{r.action || \"‚Äî\"}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <audio ref={audioRef} src={swoosh} preload=\"auto\" />\n      {!open && (\n        <div className=\"chatbot-button\" onClick={() => setOpen(true)}>\n          <i className=\"bi bi-chat-dots-fill\"></i>\n        </div>\n      )}\n      {open && (\n        <div className=\"chatbot-window\">\n          <div className=\"chatbot-header\">\n            <span>SecureEHR Assistant</span>\n            <button className=\"close-btn\" onClick={() => setOpen(false)}>\n              &times;\n            </button>\n          </div>\n\n          {/* Optional target patient */}\n          <div className=\"chatbot-toolbar\">\n            <input\n              className=\"chatbot-patient\"\n              placeholder=\"(Optional) Patient ID, e.g., Patient1\"\n              value={patientId}\n              onChange={(e) => setPatientId(e.target.value)}\n            />\n          </div>\n\n          <div className=\"chatbot-body\">\n            {messages.map((m, i) => (\n              <div key={i} className={`message ${m.type}`}>\n                <div style={{ whiteSpace: \"pre-wrap\" }}>{m.text}</div>\n\n                {/* Render stats + toggle for context when present */}\n                {m.type === \"bot\" && (m.stats || (m.rows && m.rows.length > 0)) && (\n                  <>\n                    <StatChips stats={m.stats} />\n                    <button\n                      className=\"ctx-toggle\"\n                      onClick={() => setShowContextIdx(showContextIdx === i ? null : i)}\n                    >\n                      {showContextIdx === i ? \"Hide context ‚ñ≤\" : \"Show context ‚ñº\"}\n                    </button>\n                    {showContextIdx === i && <ContextTable rows={m.rows} />}\n                  </>\n                )}\n              </div>\n            ))}\n            {loading && <div className=\"message bot\">‚è≥ Thinking‚Ä¶</div>}\n            <div ref={messagesEndRef} />\n          </div>\n\n          <div className=\"chatbot-faq\">\n            {quickQuestions.map((q, idx) => (\n              <button key={idx} onClick={() => sendMessage(q)}>{q}</button>\n            ))}\n          </div>\n\n          <div className=\"chatbot-input-area\">\n            <input\n              type=\"text\"\n              placeholder='Try: \"Show Patient1‚Äôs last visit summary\"'\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\n            />\n            <button onClick={() => sendMessage()}>\n              <i className=\"bi bi-send-fill\"></i>\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default AuditChatbot;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}